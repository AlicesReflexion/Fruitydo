{% extends "base.html" %}

{% block title %}Profile{% endblock %}

{% block content %}
{% if user.is_authenticated %}
<h1>Welcome back, {{ user.username }}</h1>
<form action="{% url 'profilepage:create' 'task_title' %}" method="post">
	{% csrf_token %}
	<input type="text" name="task_title">
	<input type="submit" value="+" class="newtaskbutton">
</form>
<h2>Incomplete tasks</h2>
<ul class="incompletetasks">
	{% for task in user.task_set.all %}
	{% if task.complete == 0 %}
	<li><form action="{% url 'profilepage:complete' task.id %}" method="post" class="completeform">
			{% csrf_token %}
			<input type="submit" value="âœ“" class="completebutton">
		</form>
		{{ task.task_title }}
		<ul>
			{% for event in task.event_set.all %}
			<li>{{ event.event_description }}</li>
			{% endfor %}
		</ul>
			<form action="{% url 'profilepage:event_create' task.id %}" method="post" class="eventform">
				{% csrf_token %}
				<textarea name="event_description"></textarea>
				<input type="submit" value="Add event" class="eventbutton">
			</form>
	</li>
	{% endif %}
	{% endfor %}
</ul>
<h2>Complete tasks</h2>
<ul class="completetasks">
	{% for task in user.task_set.all %}
	{% if task.complete == 1 %}
	<li>{{ task.task_title }}</li>
	<ul>
		{% for event in task.event_set.all %}
		<li>{{ event.event_description }}</li>
		{% endfor %}
	</ul>
	{% endif %}
	{% endfor %}
</ul>
{% endif %}
{% endblock %}

